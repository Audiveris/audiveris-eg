<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
    <HEAD>
        <!-- $Id$ -->
        
        <META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html;
                                                 charset=windows-1252"/>
        <TITLE>Audiveris Implementation Manual</TITLE> <META NAME="AUTHOR"
                                                             CONTENT="Herv&eacute;
                                                             Bitteur"/>
        
        <META NAME="CLASSIFICATION" CONTENT="Implementation Documentation of
                                             Audiveris"/>
        
        <META NAME="DESCRIPTION" CONTENT="Description of Audiveris techniques"/>
        
        <!-- The following links are meant to be solved on my local PC -->
        <!-- The java.net site uses its own style sheets -->
        
        <LINK REL="stylesheet" TYPE="text/css"
              HREF="../../branding/css/tigris.css"/>
        
        <LINK REL="stylesheet" TYPE="text/css"
              HREF="../../branding/css/inst.css"/>
    </HEAD>
    
    <BODY MARGINWIDTH="0" MARGINHEIGHT="0" CLASS="app" STYLE="text-align: justify;">
        
        <H1 ALIGN=CENTER>Audiveris Implementation Manual</H1>
        
        <ADDRESS>Author : <A
                              HREF="mailto:herve.bitteur@laposte.net">Herv&eacute;
                              Bitteur</A></ADDRESS>
        <ADDRESS>Updated :
            <SCRIPT TYPE="text/javascript" >
                document.write(parent.parent.getCVSDate("$Id$"));
            </SCRIPT>
        </ADDRESS>
        
        <DIV CLASS="warningmessage">
            <P CLASS="alert"><b>BEWARE:</b> This documentation has not yet been
                updated for Audiveris 3.0, please consider this file as
                obsolete.</P>
        </DIV>
        
        <P> Purpose of this implementation manual is to help any programmer's
            task : understanding the source code, modifying existing functions,
            adding new features, etc...</P>
        
        <A NAME="HIERARCHY">
            <H2>Folders Hierarchy</H2>
        </A>
        
        <P>Once expanded, the Audiveris archives create the structure described
            in this section :</P>
        
        <DIV  CLASS="filebrowse" >
            <UL>
                <LI CLASS="leaf">
                    <CODE><B>audiveris-M.m.jar</B></CODE> is the application jar
                    file, with "M" and "m" for release numbers.</LI>
                <LI CLASS="leaf">
                    <CODE><B>build.xml</B></CODE> is a build file, from which
                    the application can be (re)built and launched via Ant </LI>
                
                <LI CLASS="leafnode">
                    <u>bin</u>/
                    <UL>
                        <LI CLASS="leaf">
                            <CODE><B>audiveris.bat</B></CODE> is the application
                            launcher file
                        </LI>
                    </UL>
                </LI>
                
                <LI CLASS="leafnode">
                    <u>lib</u>/
                    <UL>All the companion components have their jar file located
                        in this folder.
                        <P><I>Nota : The versions for jar files are the ones
                            used at the time of this writing, but higher
                            versions should be usable as well (though not yet
                            tested)</I></P>
                        
                        <TABLE WIDTH=100% BORDER=1>
                            <TR>
                                <TH>Component</TH>
                                <TH>Purpose</TH>
                                <TH>Jar File(s)</TH>
                                <TH>Provider URL</TH>
                            </TR>
                            <TR CLASS="a">
                                <TD><B>ProxyMusic</B></TD>
                                <TD>[un]marshalling Java from/to MusicXML</TD>
                                <TD>proxymusic-1.1.jar</TD>
                                <TD><A HREF="https://proxymusic.dev.java.net/">
                                    https://proxymusic.dev.java.net/
                                    </A></TD>
                            </TR>
                            <TR CLASS="b">
                                <TD><B>JGoodies/looks</B></TD>
                                <TD>Improvement of appearance of Swing</TD>
                                <TD>looks-2.0.1.jar</TD>
                                <TD><A HREF="https://looks.dev.java.net/">
                                    https://looks.dev.java.net/
                                    </A></TD>
                            </TR>
                            <TR CLASS="a">
                                <TD><B>JGoodies/forms</B></TD>
                                <TD>Forms layout system for Swing</TD>
                                <TD>forms-1.0.6.jar</TD>
                                <TD><A HREF="https://forms.dev.java.net/">
                                    https://forms.dev.java.net/
                                    </A></TD>
                            </TR>
                            <TR CLASS="b">
                                <TD><B>JFreeChart</B></TD>
                                <TD>Chart generation, with common utilities</TD>
                                <TD>jfreechart-1.0.1.jar <BR/>
                                    jcommon-1.0.0.jar</TD>
                                <TD><A HREF="http://www.jfree.org/jfreechart/">
                                    http://www.jfree.org/jfreechart/
                                    </A></TD>
                            </TR>
                            <TR CLASS="a">
                                <TD><B>Java L&amp;F Graphics Repository</B></TD>
                                <TD>Collection of toolbar button graphics</TD>
                                <TD>jlfgr-1_0.jar</TD>
                                <TD><A
                                        HREF="http://java.sun.com/developer/techDocs/hi/repository/">
                                        http://java.sun.com/developer/techDocs/hi/repository/
                                    </A></TD>
                            </TR>
                            <TR CLASS="b">
                                <TD><B>Jama</B></TD>
                                <TD>Matrix package for linear algebra</TD>
                                <TD>Jama-1.0.2.jar</TD>
                                <TD><A
                                        HREF="http://math.nist.gov/javanumerics/jama/">
                                        http://math.nist.gov/javanumerics/jama/
                                    </A></TD>
			    </TR>
			</TABLE>
			
		    </UL>
		</LI>
		
		<LI CLASS="leafnode">
		    <u>config</u>/
		    <UL>
			<LI CLASS="leaf">
			    <CODE><B>neural-network.xml</B></CODE> is a optional
			    custom definition of the glyph neural network
			    evaluator, which is created only when you retrain
			    the network. The default definition is provided in
			    the Audiveris jar resource.</LI>
			<LI CLASS="leaf">
			    <CODE><B>logging.properties</B></CODE> is an
			    optional file which allows to set the logging level
			    of some units.</LI>
		    </UL>
		</LI>
		
		<LI CLASS="leafnode">
		    <u>examples</u>/
		    <UL>
			<LI CLASS="leaf">
			    A set of image files that can be used as input
			    examples</LI>
		    </UL>
		</LI>
		
		<LI CLASS="leafnode">
		    <u>train</u>/
		    <UL>
			<LI CLASS="leafnode">
			    core/
			    <UL>
				<LI CLASS="leaf">
				    A selected subset of the glyph material,
				    representing the "core" of the training
				    material, to be used as an efficient
				    training input for a first re-training from
				    scratch.</LI>
			    </UL>
			</LI>
			<LI CLASS="leafnode">
			    sheets/
			    <UL>
				<LI CLASS="leaf">
				    The whole base of glyph material composed by
				    all recognized glyphs stored so far. Using
				    this whole base gives the best final
				    results, but is fairly expensive in terms of
				    computing time. It is meant to be used for
				    incremental training, after the core
				    material has been used.</LI>
			    </UL>
			</LI>
		    </UL>
		</LI>
		
		<LI CLASS="leafnode">
		    <A HREF="https://audiveris.dev.java.net/servlets/ProjectDocumentList?folderID=0&expandFolder=0&folderID=3258" title="view contents">
			www/
		    </A>
		    This folder directly mirrors the Audiveris web-site on
		    java.net
		    <UL>
			<LI CLASS="leaf">
			    <A HREF="../../index.html" TARGET="_top" TITLE="view
									    file"><CODE><B>index.html</B></CODE></A>
									    is
									    the
									    web-site
									    home
									    page</LI>
			<LI CLASS="leafnode">
			    <A HREF="https://audiveris.dev.java.net/servlets/ProjectDocumentList?folderID=3258&expandFolder=3258&folderID=3259" title="view contents">
				<u>docs</u>/
			    </A>
			    <UL>
				<LI CLASS="leafnode">
				    <A HREF="https://audiveris.dev.java.net/nonav/docs/api/index.html" TARGET="_top" TITLE="view contents">
					<u>api</u>/
				    </A>
				    <UL>
					<LI CLASS="leaf">
					    The whole hierarchy of JavaDoc
					    files</LI>
				    </UL>
				</LI>
				<LI CLASS="leafnode">
				    <A HREF="https://audiveris.dev.java.net/servlets/ProjectDocumentList?folderID=3259&expandFolder=3259&folderID=3259" title="view contents">
					<u>manual</u>/
				    </A>
				    The directory contains several html files,
				    used to handle a frame layout. But the main
				    content is stored in the following files:
				    <UL>
					<LI CLASS="leaf">
					    <CODE><B>example.html</B></CODE> is
					    a quick start guide built around a
					    small example.
					</LI>
					<LI CLASS="leaf">
					    <CODE><B>installation.html</B></CODE>
					    is the installation manual you are
					    currently looking at
					</LI>
					<LI CLASS="leaf">
					    <CODE><B>operation.html</B></CODE>
					    describes how to operate the
					    application
					</LI>
					<LI CLASS="leaf">
					    <CODE><B>design.html</B></CODE>
					    presents the rationale behind
					    several Audiveris constructions (doc
					    not yet available).
					</LI>
					<LI CLASS="leaf">
					    <CODE><B>implementation.html</B></CODE>
					    details a few techniques used
					    throughout Audiveris, such as Lags,
					    GlyphLags and Sticks.
					</LI>
				    </UL>
				</LI>
				<LI CLASS="leafnode">
				    <u>wiki</u>/
				    <UL>
					<LI CLASS="leaf">
					    <CODE><B>notebook.html</B></CODE> is
					    a tiddly wiki to handle various
					    notes on Audiveris development.</LI>
				    </UL>
				</LI>
			    </UL>
			</LI>
		    </UL>
		</LI>
	    </UL>
	</DIV>
	
	<A NAME="PACKAGES">
	    <H2>Packages</H2>
	</A>
	
	<P> Let's begin by a quick overview of the Audiveris decomposition in
	    Java packages.</P>
	
	<DIV CLASS="axial">
	    
	    <A NAME="DRIVING">
		<H3>Driving Packages</H3>
	    </A>
	    
	    <P> The packages that really drive Audiveris application are the
		following ones :</P>
	    
	    <TABLE WIDTH=100% BORDER=1>
		<TR>
		    <TH>omr.sheet</TH>
		    <TD>
			This package is dedicated to the handling of the
			physical music sheet, starting with the image picture,
			and going through the sequence of processing steps.
		    </TD>
		</TR>
		<TR>
		    <TH>omr.glyph</TH>
		    <TD>
			The glyph package deals with assemblies of sections of
			foreground pixels that are matched against predefined
			shapes. These glyphs can be self-standing symbols (such
			as a clef) or leaves in larger constructions (such as
			hote heads and stem in a chord).
		    </TD>
		</TR>
		<TR>
		    <TH>omr.score</TH>
		    <TD>
			The score package handles the logical music information
			inferred from recognized glyphs extracted from the
			physical sheet. The internal representation of such
			score can be stored on an external support using various
			data formats, such as binary or XML.
		    </TD>
		</TR>
		<TR>
		    <TH>omr.ui<BR/>omr.glyph.ui</TH>
		    <TD>
			These two packages are used when Audiveris does not run
			in batch mode. The former is the general user interface,
			while the latter is focused on user interface dealing
			with glyphs.
		    </TD>
		</TR>
	    </TABLE>
	    
	    <A NAME="GEOMETRY">
		<H3>Geometry Packages</H3>
	    </A>
	    
	    <P> Audiveris relies on some geometry foundation packages :</P>
	    
	    <TABLE WIDTH=100% BORDER=1>
		<TR>
		    <TH>omr.graph</TH>
		    <TD>
			This package implements a generic directed graph, made
			of vertices linked by directed edges.
		    </TD>
		</TR>
		<TR>
		    <TH>omr.lag</TH>
		    <TD>
			The lag package deals with Linear Adjacency Graphs, a
			specialized directed graph where vertices are sections
			linked by junctions.  A section is simply a connex
			collection of pixel runs, and a run is a vector of
			foreground pixels.
		    </TD>
		</TR>
		<TR>
		    <TH>omr.stick</TH>
		    <TD>
			The stick package handles sticks, that are collections
			of sections forming either long filaments (such as staff
			lines) or shorter and straighter segments (such as bar
			lines, stems, ledgers, etc...).
		    </TD>
		</TR>
	    </TABLE>
	    
	    <A NAME="UTILITY">
		<H3>Utility Packages</H3>
	    </A>
	    
	    <P> The following packages should be considered as implementation
		helpers :</P>
	    
	    <TABLE WIDTH=100% BORDER=1>
		<TR>
		    <TH>omr.check</TH>
		    <TD>
			Here we define checks, organized in check suites, to run
			series of checks to filter out some candidates when
			looking for precise entities. This filtering technique
			is quite rough, and should perhaps be replaced by proper
			use of specific neural networks.
		    </TD>
		</TR>
		<TR>
		    <TH>omr.constant</TH>
		    <TD>
			Purpose of this package is to handle application logical
			constants in a common way, from their definition in
			their hosting classes, their potential on-line
			modification, and their persistency on disk.  If one day
			Audiveris migrates to NetBeans platform, the bulk of
			this package should disappear.
		    </TD>
		</TR>
		<TR>
		    <TH>omr.math</TH>
		    <TD>
			This is a basic collection of mathematics constructions
			such as lines, regressions, neural networks.
		    </TD>
		</TR>
		<TR>
		    <TH>omr.ui.treetable</TH>
		    <TD>
			Stolen from some Sun documentation, this implements a
			Tree/Table combination.  This should be replaced by
			proper use of some JDNC JTreeTable entity when it gets
			available.
		    </TD>
		</TR>
		<TR>
		    <TH>omr.util</TH>
		    <TD>
			This package gathers various utilities that are not
			significant enough to deserve their own package.
		    </TD>
		</TR>
	    </TABLE>
	    
	</DIV>
	
	<A NAME="PLUGINS">
	    <H2>Plugins</H2>
	</A>
	
	<A NAME="PLUGIN_MECHANISM">
	    <H3>Plugin Mechanism</H3>
	</A>

	<P> On audiveris main frame, all user actions trigerred via pulldown
	    menus or via tool bar buttons are now implemented as plugins.</P>

	<P> These can be <I><B>system</B></I> plugins which are predefined in the
	    Audiveris release, or can be <I><B>user</B></I> plugins supplied by
	    the user himself as an added feature. The only difference between
	    system and user plugins, besides their origin, is the fact they are
	    referenced in <U>/config/system.plugins</U> for the former, and
	    in <U>/config/user.plugins</U> for the latter.</P>

	<P> Here are the various items needed to get a plugin up and running:</P>
	<UL>
	    <LI> A Java class to define the action. See examples in source
		file <U>omr.ui.GuiActions.java</U></LI>
	    <UL>
		<LI> The class must implement
		    the <code>javax.swing.Action</code> interface, typically it
		    extends AbstractAction.</LI>
		<LI> The class must be <B>static</B> and have a <B>noarg
		    constructor</B> so that it is easily instantiable.</LI>
		<LI> The class byte code must be available somewhere, either in
		    the original Audiveris jar file (which is the case for
		    system plugins) or in additional any jar file or class
		    folder provided to the java command that launches
		    Audiveris.</LI>
		<LI> The class must be annotated with a <code>Plugin</code>
		    annotation. The purpose of the annotation is to specify
		    certain plugin characteristics (all characteristics have
		    default value, but the Plugin annotation must be present,
		    even if it is empty):
		    <UL>
			<LI><code>type</code> (default=DEFAULT): The section of
			    UI this action relates to. This drives the part of
			    the UI where the action will appear. By default the
			    action actually appears nowhere.</LI>
			<LI><code>dependency</code> (default=NONE): The action
			    may be enabled only if there is a current sheet or
			    if there is a current score. By default an action is
			    always enabled.</LI>
			<LI><code>item</code> (default=JMenuItem): The precise
			    (sub)class of JMenuItem to host the action in proper
			    menu. Typically this can be replaced by a
			    JCheckboxMenuItem to get additional features.</LI>
			<LI><code>onToolbar</code> (default=false): Specify
			    whether a button should be created on the
			    application tool bar.</LI>
		    </UL>
		</LI>
	    </UL>
	    <LI> The fully qualified name of the class must be listed in either
		the <U>/config/system.plugins</U> or
		the <U>/config/user.plugins</U> files. These files typically
		contain one line per class name, commented lines begin with a
		'#' character.</LI>
	    <LI> Visual characteristics for this action must be specified in the
		proper <U>/config/ui.properties</U> resource file. Depending on
		your locale setting, you may have a specific additional
		properties file, for example <U>/config/ui_fr.properties</U> for
		the French locale, to override default characteristics. In these
		properties files, keys are built by using the class fully
		qualified name, appended with a '.' character, followed by the
		Action characteristic identifier. The main characteristics
		identifiers are the following (see
		the <code>javax.swing.Action</code> class for a comprehensive
		list):
		<UL>
		    <LI>"Name": for the menu item label</LI>
		    <LI>"ShortDescription": for the tool tip text</LI>
		    <LI>"SmallIcon": for the icon both in menu and on tool
			bar</LI>
		    <LI>"AcceleratorKey": for direct access</LI>
		    <LI>"MnemonicKey": for access in menu</LI>
		</UL>
	    </LI>
	    
		

	</UL>






	    
	<A NAME="SHEET_SCORE">
	    <H2>Sheet / Score</H2>
	</A>
	
	<A NAME="SHEET_VS_SCORE">
	    <H3>Sheet vs. Score</H3>
	</A>
	
	<P> A <B>Sheet</B> handles the physical entities as extracted from the
	    printed music sheet, while the <B>Score</B> handles a structuring of
	    the inferred logical entities. This distinction has led to the
	    development of two separate packages, namely <I>omr.sheet</I>
	    and <I>omr.score</I>.</P>
	
	<P> Many entities of one package have their counterpart in the other
	    package, with link from one instance to the other.</P>
	
	<P> The following table lists the corresponding entities
	    in <I>omr.sheet</I> and in <I>omr.score</I> packages, together with
	    the Builder class that is in charge of extracting these entities
	    :</P>
	
	<UL>
	    <LI>For example, an instance of <B>Score</B> class is the
		counterpart of an instance of <B>Sheet</B> class. (We assume
		that several printed pages can be combined as a mosaic
		beforehand (a feature not yet fully implemented), so that we
		have to process just one long <B>Sheet</B>).</LI>
	    
	    <LI>The next line states that a <B>System</B> in the
		<I>omr.score</I> package is the counterpart of
		a <B>SystemInfo</B> in the <I>omr.sheet</I> package, and that
		the class <B>BarsBuilder</B> is in charge of processing
		them.</LI>
	</UL>
	
	<TABLE>
	    <TR>
		<TH>from omr.score package</TH>
		<TH>from omr.sheet package<BR/>(model&nbsp;classes)</TH>
		<TH>from omr.sheet package<BR/>(builder&nbsp;classes)</TH>
	    </TR>
	    <TR>
		<TD><A
			HREF="https://audiveris.dev.java.net/nonav/docs/api/omr/score/Score.html">
			Score</A></TD>
		<TD><A
			HREF="https://audiveris.dev.java.net/nonav/docs/api/omr/sheet/Sheet.html">
			Sheet</A></TD>
	    </TR>
	    <TR>
		<TD><A
			HREF="https://audiveris.dev.java.net/nonav/docs/api/omr/score/System.html">
			System</A></TD>
		<TD><A
			HREF="https://audiveris.dev.java.net/nonav/docs/api/omr/sheet/SystemInfo.html">
			SystemInfo</A></TD>
		<TD><A
			HREF="https://audiveris.dev.java.net/nonav/docs/api/omr/sheet/BarsBuilder.html">
			BarsBuilder</A> handles the vertical lines that are
			recognized as bar lines</TD>
	    </TR>
	    <TR>
		<TD><A
			HREF="https://audiveris.dev.java.net/nonav/docs/api/omr/score/Stave.html">
			Stave</A></TD>
		<TD><A
			HREF="https://audiveris.dev.java.net/nonav/docs/api/omr/sheet/StaveInfo.html">
			StaveInfo</A></TD>
		<TD><A
			HREF="https://audiveris.dev.java.net/nonav/docs/api/omr/sheet/LinesBuilder.html">
			LinesBuilder</A> processes the stave areas, according to
			the series of peaks found in the horizontal
			projection.</TD>
	    </TR>
	    <TR>
		<TD></TD>
		<TD><A
			HREF="https://audiveris.dev.java.net/nonav/docs/api/omr/sheet/LineInfo.html">
			LineInfo </A></TD>
		<TD><A
			HREF="https://audiveris.dev.java.net/nonav/docs/api/omr/sheet/LinesBuilder.html">
			LineBuilder</A> processes the horizontal area that
			corresponds to one histogram peak, and thus to one stave
			line.</TD>
	    </TR>
	    <TR>
		<TD><A
			HREF="https://audiveris.dev.java.net/nonav/docs/api/omr/score/Measure.html">
			Measure </A></TD>
		<TD><A
			HREF="https://audiveris.dev.java.net/nonav/docs/api/omr/sheet/BarInfo.html">
			BarInfo </A></TD>
		<TD><A
			HREF="https://audiveris.dev.java.net/nonav/docs/api/omr/sheet/BarsBuilder.html">
			BarsBuilder</A> processes the vertical lines that are
			recognized as bar lines.
		</TD>
	    </TR>
	    <TR>
		<TD></TD>
		<TD><A
			HREF="https://audiveris.dev.java.net/nonav/docs/api/omr/sheet/Ledger.html">
			Ledger </A></TD>
		<TD><A
			HREF="https://audiveris.dev.java.net/nonav/docs/api/omr/sheet/HorizontalsBuilder.html">
			HorizontalsBuilder</A> retrieves horizontal dashes in
			the given sheet. We use it for all horizontal glyphs
			(ledgers of course, but also legato signs or alternate
			endings).
		</TD>
	    </TR>
	    <TR>
		<TD></TD>
		<TD><A
			HREF="https://audiveris.dev.java.net/nonav/docs/api/omr/sheet/Ending.html">
			Ending </A></TD>
		<TD>see HorizontalsBuilder above
		</TD>
	    </TR>
	    <TR>
		<TD></TD>
		<TD><A
			HREF="https://audiveris.dev.java.net/nonav/docs/api/omr/stick/Stick.html">
			Stick</A> (vertical) </TD>
		<TD><A
			HREF="https://audiveris.dev.java.net/nonav/docs/api/omr/sheet/VerticalsBuilder.html">
			VerticalsBuilder</A> retrieves all the vertical sticks
			of all systems in the sheet at hand. Bars are assumed to
			have been already recognized, so this accounts for
			stems, vertical edges of endings, and parts of
			alterations (sharp, natural, flat).
		</TD>
	    </TR>
	    
	    <TR>
		<TD></TD>
		<TD> <A
			 HREF="https://audiveris.dev.java.net/nonav/docs/api/omr/glyph/Glyph.html">
			 Glyph </A></TD>
		<TD><A
			HREF="https://audiveris.dev.java.net/nonav/docs/api/omr/glyph/GlyphBuilder.html">
			GlyphBuilder</A> gathers non-assigned remaining glyphs
			out of a sheet.
		</TD>
	    </TR>
	</TABLE>
	
	
	<A NAME="SHEET">
	    <H3>Sheet</H3>
	</A>
	
	<P> All the music entities are organized in Systems, read from left to
	    right. Since <B>System</B> is actually an entity within
	    the <I>omr.score</I> package, here in the <I>omr.sheet</I> package
	    we use the class <A
	    HREF="https://audiveris.dev.java.net/nonav/docs/api/omr/sheet/SystemInfo.html">
	    SystemInfo</A>.</P>
	
	<P> A <B>SystemInfo</B> is the repository for all physical entities
	    found within the System, such as <A
	    HREF="https://audiveris.dev.java.net/nonav/docs/api/omr/glyph/Glyph.html">
	    Glyph</A>'s, <A
	    HREF="https://audiveris.dev.java.net/nonav/docs/api/omr/sheet/BarInfo.html">
	    BarInfo</A>'s, <A
	    HREF="https://audiveris.dev.java.net/nonav/docs/api/omr/sheet/Ledger.html">
	    Ledger</A>'s, <A
	    HREF="https://audiveris.dev.java.net/nonav/docs/api/omr/sheet/StaveInfo.html">
	    StaveInfo</A>'s, and the like.</P>
	
	<P> So, the general schema to browse through all sheet entities is
	    usually similar to the following piece of code :</P>
	
	<PRE>
	    for (SystemInfo system : sheet.getSystems()) { for (Glyph glyph :
	    system.getGlyphs()) { // Do the glyph-based processing here } }
	</PRE>
	
	<P> All the entities that result from the phase called <B>Music
	    Extraction</B> are made accessible through the collection
	    of <B>SystemInfo</B> instances. The phase called <B>Music
	    Recognition</B> should thus browse this collection and store its
	    results in the <B>Score</B> entity.</P>
	
	<A NAME="SCORE">
	    <H3>Score</H3>
	</A>
	
	<P> The <B>Score</B> is organized as a hierarchy of instances of
	    subclasses of <A
	    HREF="https://audiveris.dev.java.net/nonav/docs/api/omr/score/MusicNode.html">
	    MusicNode</A>, rooted at the Score. </P>
	
	<P> Each <B>MusicNode</B> is a tree node, with a container and a list of
	    children. To ease the traversal of the tree, every list of children,
	    wherever found in the tree, is a list of homogeneous entities. So
	    the Score hierarchy can be listed as follows :</P>
	
	<PRE>
                               Score                                                      
                                 O                                                        
                                 |                                                        
                                 |                                                        
                               Page  (not yet implemented)                                
                                 O                                                        
                                 |                                                        
                                 |                                                        
                              System                                                      
                                 O                                                        
                                 |                                                        
                                 |                                                        
                            SystemPart                                                    
                                 O                                                        
                                 |                                                        
          _________________________________________________                               
         {startingBarline, StaffList, MeasureList, SlurList}                              
                                O            O         O                                  
                                |            |         |                                  
                                |            |         |                                  
                              Staff       Measure    Slur                                 
                                             O                                            
                                             |                                            
 _______________________________________________________________________________________  
{ClefList, KeyList, Time, ChordList, BeamList, LyricList, TextList, DynamicList, Barline} 
     O        O       O        O         O          O         O            O              
     |        |       |        |         |          |         |            |              
     |        |       |        |         |          |         |            |              
   Clef    KeySig. TimeSig.  Chord     Beam       Lyric     Text        Dynamic           
                               O                    O                                     
                               |                    |                                     
                               |                    |                                     
                             Note               Syllable                                  
	</PRE>
	
	<P> The beginning of figure above can be read as follows : </P>
	<UL>
	    <LI>A <B>Score</B> has no container, and contains instances of
		class <B>System</B> as children.</LI>
	    <UL>
		<LI>A <B>System</B> has <B>Score</B> as container and exactly
		    two children : one <B>StaveList</B> and
		    one <B>SlurList</B>.</LI>
		<OL>
		    <LI>A <B>StaveList</B> has <B>System</B> as container and
			instances of <B>Stave</B>s as children.</LI>
		    <UL>
			<LI>A <B>Stave</B> has <B>StaveList</B> as container,
			    and exactly four children : one <B>LyricList</B>,
			    one <B>TextList</B>, one <B>DynamicList</B> and
			    one <B>MeasureList</B>.</LI>
			<LI>Etc...</LI>
		    </UL>
		    <LI>A <B>SlurList</B> has <B>System</B> as container and
			instances of <B>Slur</B>s as children.</LI>
		</OL>
	    </UL>
	</UL>
	
	<P> The hierarchical nature of this structure can be conveniently used
	    by various traversals. It is used for example when the physical
	    counterpart of each music node has to be rendered in the Sheet
	    display (see method <A
	    HREF="https://audiveris.dev.java.net/nonav/docs/api/omr/score/MusicNode.html#renderNode(java.awt.Graphics,
	    omr.ui.Zoom)"> renderNode()</A>).</P>
	
	<P> Though it's currently disabled, but the source code is still
	    available, a <B>ScoreView</B> window was dedicated to the painting
	    of Score entities, using method <A
	    HREF="https://audiveris.dev.java.net/nonav/docs/api/omr/score/MusicNode.html#paintNode(java.awt.Graphics)">
	    paintNode()</A>.</P>
	
	<P> A similar construction could be used, probably coupled with Castor,
	    to store the content of a Score using the MusicXML format.</P>
	
	
	
	
	<BR/>
	<BR/>
	<HR/> 
	<I>End of Implementation Manual</I>
	
    </BODY>
</HTML>
